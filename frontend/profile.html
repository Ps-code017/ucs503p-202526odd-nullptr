<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Profile</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script  src="main.js"></script>
  <style>
    body { padding: 20px; font-family: sans-serif; }
    input { width: 100%; padding: 12px; margin-top: 10px; }
    button { margin-top: 20px; padding: 12px; width: 100%; }
  </style>
</head>
<body>

<h2>My Profile</h2>

<div>
  <label>Skills (comma separated)</label>
  <input id="skillsInput" placeholder="Python, React, AWS" />
</div>

<button onclick="saveSkills()">Save</button>
<button onclick="window.location.href='index.html'">Back</button>

<script>
(async () => {
Â  try {
Â  Â  console.log("Loading profile... before apiGet in profile.html");
Â  Â  const me = await apiGet("/api/users/me");
Â  Â  console.log("Profile loaded: after apiGet in profile.html", me);
Â  Â  
    // ðŸŒŸ FIX: Use the OR operator (||) to provide an empty array if me.skills is undefined/null
Â  Â  document.getElementById("skillsInput").value = (me.skills || []).join(", "); 
Â  Â  
Â  Â  return;
Â  } catch(err) {
Â  Â  console.error("Auth failed:", err.message); 
Â  Â  logout();
Â  Â  
Â  Â  setTimeout(() => {
Â  Â  Â  Â  window.location.href = "login.html";
Â  Â  }, 1000);
Â  }
})();

async function saveSkills() {
Â  try {
  const skills = document.getElementById("skillsInput").value
  Â  Â  .split(",")
  Â  Â  .map(s => s.trim());
  
  Â  // CHANGE apiPost to apiPut
  Â  await apiPut("/api/users/skills", { skills }); 
  Â  alert("Saved!");
} catch (error) {
  alert(`Failed to save skills: ${error.message || "Unknown error"}`);
}
}
</script>

</body>
</html>
